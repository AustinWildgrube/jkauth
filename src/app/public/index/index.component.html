<!--Done-->
<div class="index">
  <div class="index_banner">
    <img class="index__banner-image" src="assets/images/ashe.png" alt="Ashe Banner Image">

    <div class="index__banner-text">
      <h1 class="index__banner-title">Play Better.</h1>
      <span class="index__banner-description">We have everything you need to play smarter, not harder. Stomp the enemy team with
        confidence.
      </span>
    </div>
  </div>

  <h2 class="index__product-section-title">Newest Products</h2>
  <div class="index__products">
    <ng-container *ngFor="let script of newScriptsList; let i = index">
      <div *ngIf="isAuthenticated" class="index__product"
           (mouseover)="script.price_eur !== -1 && script.price_eur !== 0 ? productHover(i, true): ''"
           (mouseout)="script.price_eur !== -1 && script.price_eur !== 0 ? productHover(i, false) : ''">
        <ngx-skeleton-loader *ngIf="!isLoaded" appearance="circle" [theme]="{width: '211.667px', height: '200px',
                                                                    'border-radius': '3px', 'margin': '0'}">
        </ngx-skeleton-loader>
        <img *ngIf="script.image && isLoaded" class="index__product-image" (click)="holdScriptToAdd(script);
             openModal(productInfo)" [src]="script.image | safe: 'url'"
             [alt]="script.sname + ' Product Image'">
        <span *ngIf="!script.image && isLoaded" class="index__product-image" (click)="holdScriptToAdd(script);
              openModal(productInfo)"></span>

        <div class="index__product-details">
          <ngx-skeleton-loader *ngIf="!isLoaded" [theme]="{width: '187px', height: '18px', 'margin': '0'}">
          </ngx-skeleton-loader>

          <h3 *ngIf="isLoaded" class="index__product-name" (click)="holdScriptToAdd(script);
              openModal(productInfo)">{{ script.sname }}</h3>

          <ngx-skeleton-loader *ngIf="!isLoaded" [theme]="{width: '100px', height: '18px', 'margin': '0'}">
          </ngx-skeleton-loader>

          <span *ngIf="isLoaded" class="index__product-author" (click)="holdScriptToAdd(script);
                openModal(productInfo)">
            <ng-container *ngIf="script.name !== 'Dalenka'">
              {{ script.name }}
            </ng-container>
            <ng-container *ngIf="script.name === 'Dalenka'">
              MrImpressive
            </ng-container>
          </span>

          <span *ngIf="isLoaded && (!isHovered || isHovered && hoveredIndex !== i)" class="index__product-price">
            <ng-container *ngIf="script.price_1_day !== -1">
              {{ script.price_1_day | currency: 'EUR' }} / Day
            </ng-container>
            <ng-container *ngIf="script.price_1_day === -1 && script.price_1_week !== -1">
              {{ script.price_1_week | currency: 'EUR' }} / Week
            </ng-container>
            <ng-container *ngIf="script.price_1_day === -1 && script.price_1_week === -1 && script.price_1_month !== -1">
              {{ script.price_1_month | currency: 'EUR' }} / Month
            </ng-container>
            <ng-container *ngIf="script.price_1_day === -1 && script.price_1_week === -1 && script.price_1_month === -1
                                 && script.price_eur !== 9999999 && script.price_eur !== -1 && script.price_eur !== 0">
              {{ script.price_eur | currency: 'EUR' }} / Lifetime
            </ng-container>
            <ng-container *ngIf="script.price_eur === -1 || script.price_eur === 0">
              Free
            </ng-container>
          </span>

          <span *ngIf="isLoaded && (isHovered && hoveredIndex === i)" class="index__product-cart"
                (click)="holdScriptToAdd(script); addToCart(false)">
            Add to cart
          </span>

          <ngx-skeleton-loader *ngIf="!isLoaded" [theme]="{width: '75px', height: '18px', 'margin': '0'}">
          </ngx-skeleton-loader>
        </div>
      </div>

      <div *ngIf="!isAuthenticated" class="index__product">
        <ngx-skeleton-loader *ngIf="!isLoaded" appearance="circle" [theme]="{width: '211.667px', height: '200px',
                                                                    'border-radius': '3px', 'margin': '0'}">
        </ngx-skeleton-loader>
        <img *ngIf="script.image && isLoaded" class="index__product-image" (click)="loginPrompt()"
             [src]="script.image | safe: 'url'" [alt]="script.sname + ' Product Image'">
        <span *ngIf="!script.image && isLoaded" class="index__product-image" (click)="loginPrompt()"></span>

        <div class="index__product-details">
          <ngx-skeleton-loader *ngIf="!isLoaded" [theme]="{width: '187px', height: '18px', 'margin': '0'}">
          </ngx-skeleton-loader>

          <h3 *ngIf="isLoaded" class="index__product-name" (click)="loginPrompt()">{{ script.sname }}</h3>

          <ngx-skeleton-loader *ngIf="!isLoaded" [theme]="{width: '100px', height: '18px', 'margin': '0'}">
          </ngx-skeleton-loader>

          <span *ngIf="isLoaded" class="index__product-author" (click)="loginPrompt()">
            <ng-container *ngIf="script.name !== 'Dalenka'">
              {{ script.name }}
            </ng-container>
            <ng-container *ngIf="script.name === 'Dalenka'">
              MrImpressive
            </ng-container>
          </span>

          <span *ngIf="!isAuthenticated && isLoaded" class="index__product-price" (click)="loginPrompt()">
            <ng-container *ngIf="script.price_1_day !== -1">
              {{ script.price_1_day | currency: 'EUR' }} / Day
            </ng-container>
            <ng-container *ngIf="script.price_1_day === -1 && script.price_1_week !== -1">
              {{ script.price_1_week | currency: 'EUR' }} / Week
            </ng-container>
            <ng-container *ngIf="script.price_1_day === -1 && script.price_1_week === -1 && script.price_1_month !== -1">
              {{ script.price_1_month | currency: 'EUR' }} / Month
            </ng-container>
            <ng-container *ngIf="script.price_1_day === -1 && script.price_1_week === -1 && script.price_1_month === -1
                                 && script.price_eur !== 9999999 && script.price_eur !== -1 && script.price_eur !== 0">
              {{ script.price_eur | currency: 'EUR' }} / Lifetime
            </ng-container>
            <ng-container *ngIf="script.price_eur === -1 || script.price_eur === 0">
              Free
            </ng-container>
          </span>

          <ngx-skeleton-loader *ngIf="!isLoaded" [theme]="{width: '75px', height: '18px', 'margin': '0'}">
          </ngx-skeleton-loader>
        </div>
      </div>
    </ng-container>
  </div>
</div>

<ng-template #productInfo>
  <div class="modal modal-content">
    <div class="modal__header modal__header--align-left">
      <h3 class="modal__header-title">{{ scriptToAdd.sname }}</h3>
      <span *ngIf="this.noKeyLengthSelected" class="modal__header-error">Please select key length</span>
      <ng-container *ngIf="scriptToAdd.price_1_day != -1">
        <h3 class="modal__header-price">{{ scriptToAdd.price_1_day | currency: 'EUR' }} Day</h3>
      </ng-container>
      <ng-container *ngIf="scriptToAdd.price_1_week != -1">
        <h3 class="modal__header-price">{{ scriptToAdd.price_1_week | currency: 'EUR' }} Week</h3>
      </ng-container>
      <ng-container *ngIf="scriptToAdd.price_1_month != -1">
        <h3 class="modal__header-price">{{ scriptToAdd.price_1_month | currency: 'EUR' }} Month</h3>
      </ng-container>
      <ng-container *ngIf="scriptToAdd.price_eur != 9999999 && scriptToAdd.price_eur != -1 &&
                           scriptToAdd.price_eur != 0">
        <h3 class="modal__header-price">{{ scriptToAdd.price_eur | currency: 'EUR' }} Lifetime</h3>
      </ng-container>
      <ng-container *ngIf="scriptToAdd.price_eur === -1 || scriptToAdd.price_eur === 0">
        <h3 class="modal__header-price">This script is not paid</h3>
      </ng-container>
    </div>
    <div class="modal__body container-fluid">
      <p class="modal__body-text" [innerHTML]="scriptToAdd.sinfo"></p>
    </div>

    <footer *ngIf="scriptToAdd.price_eur !== -1 && scriptToAdd.price_eur !== 0" class="modal__footer modal__footer--actions">
      <form class="row no-gutters modal__footer-form" [formGroup]="keyForm" (ngSubmit)="addToCart(true)">
        <input class="modal__footer-quantity form-control" formControlName="keyAmount" type="number" placeholder="Number of Keys"
               min="1" aria-label="Quantity">

        <select class="modal__footer-quantity form-control" formControlName="keyLength" aria-label="Key Length">
          <option value>Select A Key Length</option>
          <ng-container *ngIf="scriptToAdd.price_1_day != -1">
            <option value="1">Day</option>
          </ng-container>
          <ng-container *ngIf="scriptToAdd.price_1_week != -1">
            <option value="7">Week</option>
          </ng-container>
          <ng-container *ngIf="scriptToAdd.price_1_month != -1">
            <option value="31">Month</option>
          </ng-container>
          <ng-container *ngIf="scriptToAdd.price_eur != 9999999 && scriptToAdd.price_eur != -1 &&
                           scriptToAdd.price_eur != 0">
            <option value="-1">Lifetime</option>
          </ng-container>
        </select>

        <button class="button" type="submit">Add to Cart</button>
      </form>
    </footer>
  </div>
</ng-template>
