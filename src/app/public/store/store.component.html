<!--Done-->
<div class="store">
  <div class="store__filters">
    <h2 class="store__product-section-title">All Products</h2>
    <input class="store__filter-input form-control" [(ngModel)]="searchTerm" placeholder="Search Products" type="text"
           aria-label="Search Products">
  </div>

  <div class="store__products">
    <div *ngFor="let script of newScriptsList | filter: searchTerm; let i = index" class="store__product"
         (mouseover)="productHover(i, true)" (mouseout)="productHover(i, false)">

      <ngx-skeleton-loader *ngIf="!isLoaded" appearance="circle" [theme]="{width: '211.667px', height: '200px',
                                                                  'border-radius': '3px', 'margin': '0'}">
      </ngx-skeleton-loader>

      <img *ngIf="script.image && isLoaded" class="store__product-image" (click)="holdScriptToAdd(script);
            openModal(productInfo)" [src]="script.image" [alt]="script.sname + ' Product Image'">
      <span *ngIf="!script.image && isLoaded" class="store__product-image" (click)="holdScriptToAdd(script);
            openModal(productInfo)"></span>

      <div class="store__product-details">
        <ngx-skeleton-loader *ngIf="!isLoaded" [theme]="{width: '187px', height: '18px', 'margin': '0'}">
        </ngx-skeleton-loader>

        <h3 *ngIf="isLoaded" class="store__product-name" (click)="holdScriptToAdd(script);
            openModal(productInfo)">{{ script.sname }}</h3>

        <ngx-skeleton-loader *ngIf="!isLoaded" [theme]="{width: '100px', height: '18px', 'margin': '0'}">
        </ngx-skeleton-loader>

        <span *ngIf="isLoaded" class="store__product-author" (click)="holdScriptToAdd(script);
            openModal(productInfo)">
          <ng-container *ngIf="script.name !== 'Dalenka'">
            {{ script.name }}
          </ng-container>
          <ng-container *ngIf="script.name === 'Dalenka'">
            MrImpressive
          </ng-container>
        </span>

        <span *ngIf="!isAuthenticated && isLoaded" class="store__product-price">
          {{ script.price_eur | currency: 'EUR' }}
        </span>
        <span *ngIf="isAuthenticated && isLoaded && (!isHovered || isHovered && hoveredIndex !== i)"
              class="store__product-price">
          {{ script.price_eur | currency: 'EUR' }}
        </span>
        <span *ngIf="isAuthenticated && isLoaded && (isHovered && hoveredIndex === i)" class="index__product-cart"
              (click)="holdScriptToAdd(script); addToCart(false)">
          Add to cart
        </span>

        <ngx-skeleton-loader *ngIf="!isLoaded" [theme]="{width: '75px', height: '18px', 'margin': '0'}">
        </ngx-skeleton-loader>
      </div>
    </div>
  </div>
</div>

<ng-template #productInfo>
  <div class="modal modal-content">
    <div class="modal__header modal__header--align-left">
      <h3 class="modal__header-title">{{ scriptToAdd.sname }}</h3>
      <h3 class="modal__header-price">{{ scriptToAdd.price_eur | currency: 'EUR' }}</h3>
    </div>
    <div class="modal__body container-fluid">
      <p class="modal__body-text" [innerHTML]="scriptToAdd.sinfo"></p>
    </div>

    <footer class="modal__footer modal__footer--actions">
      <form class="row no-gutters modal__footer-form" [formGroup]="keyForm" (ngSubmit)="addToCart(true)">
        <input class="modal__footer-quantity form-control" formControlName="keyAmount" type="number"
               placeholder="Number of Keys" min="1" aria-label="Quantity">
        <button class="button" type="submit">Add to Cart</button>
      </form>
    </footer>
  </div>
</ng-template>
